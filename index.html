<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Pythia AR Reader</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- 1. Core AR Engine -->
    <script src="encantar.js"></script>
    
    <!-- 2. A-Frame (3D Engine) -->
    <script src="https://cdn.jsdelivr.net/npm/aframe@1.6.0/dist/aframe-v1.6.0.min.js"></script>
    
    <!-- 3. Integration Layer -->
    <script src="aframe-with-encantar.js"></script>

    <style>
      body { margin: 0; overflow: hidden; background-color: transparent; }
      #info {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 999;
        color: white;
        font-family: sans-serif;
        background: rgba(0, 0, 0, 0.5);
        padding: 10px;
        pointer-events: none;
      }
    </style>
  </head>
  <body>
    <div id="info">
      <h3>Pythia</h3>
      <p>Point camera at the target image.</p>
    </div>

    <!-- 
      encantar="stats: true" enables the performance stats widget 
      gizmos: true shows debug lines for tracking 
    -->
    <a-scene encantar="stats: true; gizmos: true" vr-mode-ui="enabled: false">
      
      <!-- AR Configuration -->
      <ar-sources>
        <ar-camera-source resolution="lg" facing-mode="environment"></ar-camera-source>
      </ar-sources>

      <ar-viewport></ar-viewport>

      <ar-trackers>
        <!-- database-size: 'sm' | 'md' | 'lg' determines the dictionary size -->
        <ar-image-tracker resolution="lg" database-size="md">
          <ar-reference-image name="marker" src="marker.png"></ar-reference-image>
        </ar-image-tracker>
      </ar-trackers>

      <!-- 
        AR Content 
        Use <ar-root reference-image="name"> to attach content to a tracker.
      -->
      
      <ar-root reference-image="marker">
        <a-entity 
          gltf-model="url(2geogen-asset.glb)" 
          position="0 0 0" 
          scale="0.5 0.5 0.5"
          animation="property: rotation; to: 0 360 0; loop: true; dur: 10000; easing: linear">
        </a-entity>
      </ar-root>

      <!-- The Camera -->
      <ar-camera>
        <!-- HUD or fixed elements can go here -->
      </ar-camera>

    </a-scene>

    <script>
      // Simple event logging to verify the engine is running
      const scene = document.querySelector('a-scene');
      
      scene.addEventListener('arready', () => {
        console.log('AR System is ready!');
        document.querySelector('#info p').textContent = 'System Ready. Scanning...';
      });

      scene.addEventListener('artargetfound', (ev) => {
        const targetName = ev.detail.referenceImage.name;
        console.log(`Target found: ${targetName}`);
        document.querySelector('#info p').textContent = `Found: ${targetName}`;
      });

      scene.addEventListener('artargetlost', (ev) => {
        const targetName = ev.detail.referenceImage.name;
        console.log(`Target lost: ${targetName}`);
        document.querySelector('#info p').textContent = `Lost: ${targetName}`;
      });
    </script>
  </body>
</html>